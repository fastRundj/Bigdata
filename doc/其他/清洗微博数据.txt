原始数据：
{"ID":"6075797252","信息":{"关注数":"1327","标签":"","微博数":"71","粉丝数":"29"},"全部评论":[],"内容":":【名人战16强对阵：范蕴若VS柯洁 周睿羊VS时越】2016年12月24日，嫘祖杯名人战32强战战罢。16强战将于12月26日9：30在中国棋院打响。16强战国宇征VS芈昱廷，范蕴若VS柯洁，孟泰龄VS柁嘉熹。O名人16强对阵：范蕴若VS柯洁 ​","发布时间":"2016-12-26 06:02:34","昵称":"念Cassie黄","点赞数":"0","网址":"https://weibo.cn/comment/EnPZTEuYC?uid=6075797252&rl=1#cmtfrm","评论数":"0","转发数":"2"}
{"ID":"1648464477","信息":{"标签":"","微博数":"5920","性别":"男","粉丝数":"62","昵称":"先锋队111","地区":"河北 沧州","关注数":"36","生日":"01-01"},"全部评论":[],"内容":":发表了博文《第29届中国围棋名人战：芈昱廷、周睿羊将争挑战权》首页参赛报名新闻中心往届回顾合作伙伴相关赛事第29届中国围棋名人战半决赛在人民网进行嫘祖杯第29届中国围棋名人战开幕第29届中国围棋名人战第29届中国围棋名人战：芈昱廷、周睿羊将争挑战权 ​","发布时间":"2017年01月11日 10:46","昵称":"先锋队111","点赞数":"0","网址":"https://weibo.cn/comment/EqiH81YWr?uid=1648464477&rl=1#cmtfrm","评论数":"0","转发数":"0"}
{"ID":"1730866981","信息":{"粉丝数":"830006","关注数":"892","简介":"新浪体育棋牌频道官方微博，专业于各项棋牌类赛事报道。","性别":"男","地区":"北京","标签":"棋牌、五子棋、国际跳棋","生日":"0001-00-00","认证":"新浪体育滚动播报棋牌新闻","认证信息":"新浪体育滚动播报棋牌新闻","昵称":"棋牌新闻","微博数":"34439"},"全部评论":[{"点赞数":"0","内容":"转发微博","评论人":"唐葫芦串儿"},{"点赞数":"0","内容":"回复 $岩一民$ :说睿羊弱，陈耀烨第一个不同意","评论人":"岩一民"},{"点赞数":"0","内容":"回复 $沙子世界观$ :睿羊少一点杀气，其实近5，6年以来都是世界一流棋手","评论人":"岩一民"},{"点赞数":"1","内容":"羊羊最近厉害啊[good]","评论人":"石头的世界观"},{"点赞数":"1","内容":"近期状态最好的俩棋手","评论人":"撒拉哈丁"},{"点赞数":"0","内容":"看好羊羊","评论人":"谷林无悔"},{"点赞数":"1","内容":"周睿羊看来从master那学到真传了，上盘对谈笑弃子包封，这盘尖冲宇宙流，谁学到家谁厉害。","评论人":"天下无斑001"},{"点赞数":"0","内容":"都是一流棋手","评论人":"岩一民"},{"点赞数":"0","内容":"回复 $高Way$ :在下不是芈老师。剩下的阁下不妨看在下此条评论先前的回复。","评论人":"dancefly77"},{"点赞数":"0","内容":"回复 $dancefly77$ :请问最近的新锐战冠军是你得的吗？","评论人":"高Way"},{"点赞数":"0","内容":"转发微博","评论人":"唐葫芦串儿"},{"点赞数":"0","内容":"回复 $岩一民$ :说睿羊弱，陈耀烨第一个不同意","评论人":"岩一民"},{"点赞数":"0","内容":"回复 $沙子世界观$ :睿羊少一点杀气，其实近5，6年以来都是世界一流棋手","评论人":"岩一民"},{"点赞数":"1","内容":"羊羊最近厉害啊[good]","评论人":"石头的世界观"},{"点赞数":"1","内容":"近期状态最好的俩棋手","评论人":"撒拉哈丁"},{"点赞数":"0","内容":"看好羊羊","评论人":"谷林无悔"},{"点赞数":"1","内容":"周睿羊看来从master那学到真传了，上盘对谈笑弃子包封，这盘尖冲宇宙流，谁学到家谁厉害。","评论人":"天下无斑001"},{"点赞数":"0","内容":"都是一流棋手","评论人":"岩一民"},{"点赞数":"0","内容":"回复 $高Way$ :在下不是芈老师。剩下的阁下不妨看在下此条评论先前的回复。","评论人":"dancefly77"},{"点赞数":"0","内容":"回复 $dancefly77$ :请问最近的新锐战冠军是你得的吗？","评论人":"高Way"}],"内容":":【名人战周睿羊胜杨鼎新 将与芈昱廷争夺挑战权】北京时间1月10日，嫘祖杯第29届中国围棋名人战挑战者半决赛在人民网战罢。最终，@睿羊 和芈昱廷分别击败杨鼎新和黄云嵩，周睿羊将与芈昱廷在12日展开对决，争夺向现任名人连笑挑战的资格。详情名人战周睿羊芈昱廷争挑战权 ​","发布时间":"2017年01月10日 17:15","昵称":"棋牌新闻","点赞数":"19","网址":"https://weibo.cn/comment/EqbOppfol?uid=1730866981&rl=1#cmtfrm","评论数":"16","转发数":"12"}
{"ID":"1730866981","信息":{"微博数":"34439","生日":"0001-00-00","昵称":"棋牌新闻","关注数":"892","地区":"北京","性别":"男","标签":"棋牌、五子棋、国际跳棋","粉丝数":"829946","简介":"新浪体育棋牌频道官方微博，专业于各项棋牌类赛事报道。","认证":"新浪体育滚动播报棋牌新闻","认证信息":"新浪体育滚动播报棋牌新闻"},"全部评论":[{"点赞数":"0","内容":"小黄同志的黑皮鞋搭白袜子亮了","评论人":"红楼隔语"},{"点赞数":"2","内容":"桌子这么低棋手不要得颈椎病么","评论人":"用孩童之眼窺視戰爭"},{"点赞数":"0","内容":"末日和孔明这是杠上了。。","评论人":"韩笑-conundrum"},{"点赞数":"0","内容":"这个对局室布置得还像个样子","评论人":"塞外江南113"}],"内容":":【高清-名人战半决赛打响 周睿羊杨鼎新全力以赴】1月10日，第29届“嫘祖杯”中国围棋名人战半决赛在人民网演播厅打响。名人战四强战 ​","发布时间":"2017年01月10日 10:39","昵称":"棋牌新闻","点赞数":"11","网址":"https://weibo.cn/comment/Eq9dSm5IX?uid=1730866981&rl=1#cmtfrm","评论数":"4","转发数":"5"}


测试数据：
{"ID":"1730866981","好1":{"好19":"34439","好17":"0001-00-00","好10":"棋牌新闻","好11":"892","好16":"北京","好15":"男","好12":"棋牌、五子棋、国际跳棋","好14":"829946","好18":"新浪体育棋牌频道官方微博，专业于各项棋牌类赛事报道。","好13":"新浪体育滚动播报棋牌新闻","认证信息":"新浪体育滚动播报棋牌新闻"},"好20":[{"点赞数":"0","内容":"好1","评论人":"好1"},{"点赞数":"2","内容":"好1","评论人":"好1"}],"内容":"123第二十九届名人战四强战 ​","发布时间":"2017年01月10日 10:39","昵称":"棋牌新闻","点赞数":"11","网址":"https://weibo.cn/comment/Eq9dSm5IX?uid=1730866981&rl=1#cmtfrm","评论数":"2","转发数":"5"}
{"ID":"1730866981","好1":{"好19":"34439","好17":"0001-00-00","好10":"棋牌新闻","好11":"892","好16":"北京","好15":"男","好12":"棋牌、五子棋、国际跳棋","好14":"829946","好18":"新浪体育棋牌频道官方微博，专业于各项棋牌类赛事报道。","好13":"新浪体育滚动播报棋牌新闻","认证信息":"新浪体育滚动播报棋牌新闻"},"好20":[{"点赞数":"0","内容":"好1","评论人":"好1"},{"点赞数":"2","内容":"好1","评论人":"好1"}],"内容":"123第二十九届名人战四强战 ​","发布时间":"2017年01月10日 10:39","昵称":"棋牌新闻","点赞数":"11","网址":"https://weibo.cn/comment/Eq9dSm5IX?uid=1730866981&rl=1#cmtfrm","评论数":"2","转发数":"5"}
{"ID":"1730866981","好1":{"好19":"34439","好17":"0001-00-00","好10":"棋牌新闻","好11":"892","好16":"北京","好15":"男","好12":"棋牌、五子棋、国际跳棋","好14":"829946","好18":"新浪体育棋牌频道官方微博，专业于各项棋牌类赛事报道。","好13":"新浪体育滚动播报棋牌新闻","认证信息":"新浪体育滚动播报棋牌新闻"},"好20":[{"点赞数":"0","内容":"好1","评论人":"好1"},{"点赞数":"2","内容":"好1","评论人":"好1"},{"点赞数":"2","内容":"好1","评论人":"好1"}],"内容":"123第二十九届名人战四强战 ​","发布时间":"2017年01月10日 10:39","昵称":"棋牌新闻","点赞数":"11","网址":"https://weibo.cn/comment/Eq9dSm5IX?uid=1730866981&rl=1#cmtfrm","评论数":"3","转发数":"5"}
{"ID":"1730866981","好1":{"好19":"34439","好17":"0001-00-00","好10":"棋牌新闻","好11":"892","好16":"北京","好15":"男","好12":"棋牌、五子棋、国际跳棋","好14":"829946","好18":"新浪体育棋牌频道官方微博，专业于各项棋牌类赛事报道。","好13":"新浪体育滚动播报棋牌新闻","认证信息":"新浪体育滚动播报棋牌新闻"},"好20":[{"点赞数":"0","内容":"好123","评论人":"好1"},{"点赞数":"2","内容":"。","评论人":"好1"}],"内容":"第二十九届名人战四强战 ​","发布时间":"2017年01月10日 10:39","昵称":"棋牌新闻","点赞数":"11","网址":"https://weibo.cn/comment/Eq9dSm5IX?uid=1730866981&rl=1#cmtfrm","评论数":"2","转发数":"5"}
{"ID":"1730866981","好1":{"好19":"34439","好17":"0001-00-00","好10":"棋牌新闻","好11":"892","好16":"北京","好15":"男","好12":"棋牌、五子棋、国际跳棋","好14":"829946","好18":"新浪体育棋牌频道官方微博，专业于各项棋牌类赛事报道。","好13":"新浪体育滚动播报棋牌新闻","认证信息":"新浪体育滚动播报棋牌新闻"},"好20":[{"点赞数":"0","内容":"","评论人":"好1"},{"点赞数":"2","内容":"。","评论人":""}],"内容":"123第二十九届名人战四强战 ​","发布时间":"2017年01月10日 10:39","昵称":"棋牌新闻","点赞数":"11","网址":"https://weibo.cn/comment/Eq9dSm5IX?uid=1730866981&rl=1#cmtfrm","评论数":"2","转发数":"5"}
{"ID":"6075797252","好1":{"好11":"1327","好12":"","好19":"71","好14":"29"},"好20":[],"内容":"范蕴若VS柯洁 ​","发布时间":"2016-12-26 06:02:34","昵称":"123八强VS二十九届","点赞数":"0","网址":"https://weibo.cn/comment/EnPZTEuYC?uid=6075797252&rl=1#cmtfrm","评论数":"0","转发数":"2"}


微博原有属性：ID、信息{昵称、关注数、标签、认证、粉丝数、性别、地区、生日、简介、微博数、认证信息}、
全部评论、内容、发布时间、昵称、点赞数、网址、评论数、转发数

处理后的属性：ID、信息{昵称、关注数、标签、认证、粉丝数、性别、地区、生日、简介、微博数}、
全部评论[{点赞数、内容、评论人},...]、内容、发布时间、昵称、点赞数、网址、评论数、转发数

测试字段对应关系：    ID、好1{好10、好11、好12、好13、好14、好15、好16、好17、好18、好19}、好20、。。

注意：原始数据中"信息"中的字段顺序或个数可能不一致，但存储HBase时不影响，读取处理时，需要自己知道字段对应关系。


清洗规则：
针对微博：
1、去重
2、过滤：
 1）评论数为0，将"全部评论"字段置为''。
 2）评论数不为0，但所有评论者的评论内容是：单字符、标点符号等，将"全部评论"字段置为''。
3、针对内容进行转换：四强--> 4强；八强-->8强；第二十九届-->第29届
4、删除"信息"中的"认证信息"字段，该字段与"认证"字段内容重复。
5、全部评论中，删除其内容只有单个字符、标点的评论，且评论数对应减少。
6、由于HBase只能存储字符串，且处理结果中，"信息"字段的vlaue为json对象，"全部评论"字段的vlaue为：json对象组成的列表，[{},{},{}]
  因此，需要转换为字符串。如下是两个字段在pyspark查出的结果显示：
  

"信息":{"微博数":"34439","生日":"0001-00-00","昵称":"棋牌新闻","关注数":"892",
"地区":"北京","性别":"男","标签":"棋牌、五子棋、国际跳棋","粉丝数":"829946",
"简介":"新浪体育棋牌频道官方微博，专业于各项棋牌类赛事报道。","认证":"新浪体育滚动播报棋牌新闻",
"认证信息":"新浪体育滚动播报棋牌新闻"},

"全部评论":[{"点赞数":"0","内容":"小黄同志的黑皮鞋搭白袜子亮了","评论人":"红楼隔语"},
{"点赞数":"2","内容":"桌子这么低棋手不要得颈椎病么","评论人":"用孩童之眼窺視戰爭"},
{"点赞数":"0","内容":"末日和孔明这是杠上了。。","评论人":"韩笑-conundrum"},
{"点赞数":"0","内容":"这个对局室布置得还像个样子","评论人":"塞外江南113"}],

"内容":":【高清-名人战半决赛打响 周睿羊杨鼎新全力以赴】1月10日，第29届“嫘祖杯”中国围棋名人战半决
赛在人民网演播厅打响。名人战四强战 ​",

"发布时间":"2017年01月10日 10:39","昵称":"棋牌新闻","点赞数":"11",
"网址":"https://weibo.cn/comment/Eq9dSm5IX?uid=1730866981&rl=1#cmtfrm","评论数":"4","转发数":"5"}

    
spark-submit --master spark://cdh-master-slave1:7077 --name test_weibo --executor-memory 5g \
--name wordcount --conf "spark.app.id=wordcount" examples/lib/wordcount.py /data/inputfile.txt 

spark-submit --name weibo_to_HBase.py --master spark://cdh-master-slave1:7077 --driver-memory 6g --executor-cores 4 \
--executor-memory 4g --total-executor-cores 4 \
weibo_to_HBase.py cdh-slave2 weibo
